<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>J君優化專案首頁v1</title>
    <!-- Share Preview (Open Graph / Twitter Card) -->
    <meta property="og:title" content="J君優化專案首頁">
    <meta property="og:description" content="專案連結與資源彙整">
    <meta property="og:type" content="website">
    <!-- TODO: 把 content 改成你實際要分享的頁面網址（例如 GitHub Pages 網址） -->
    <meta property="og:url" content="">
    <meta property="og:image" content="https://raw.githubusercontent.com/jimmywu-commits/index/refs/heads/main/jimmypic.png">
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="J君優化專案首頁">
    <meta name="twitter:description" content="專案連結與資源彙整">
    <meta name="twitter:image" content="https://raw.githubusercontent.com/jimmywu-commits/index/refs/heads/main/jimmypic.png">
    <link rel="icon" href="https://raw.githubusercontent.com/jimmywu-commits/index/refs/heads/main/jimmypic.png">
    <style>
        :root {
            --primary: #00f2ff;
            --edit: #ffca28;
            --danger: #ff4d4d;
            --bg: #0a0e17;
            --card-bg: #11151c;
            --glow: 0 10px 30px rgba(0, 242, 255, 0.25);
        }

        body {
            background-color: var(--bg);
            color: #ffffff;
            font-family: 'PingFang TC', 'Microsoft JhengHei', sans-serif;
            margin: 0; padding: 80px 20px;
            display: flex; flex-direction: column; align-items: center;
            -webkit-font-smoothing: antialiased;
        }

        a { text-decoration: none !important; color: inherit; outline: none; }

        .admin-controls {
            position: fixed; top: 20px; right: 20px;
            display: flex; gap: 10px; z-index: 1000;
        }

        .btn {
            border: 1px solid var(--primary);
            padding: 8px 18px; border-radius: 4px;
            font-weight: bold; cursor: pointer; transition: 0.2s;
            background: #000; color: var(--primary);
        }

        .btn:hover { background: var(--primary); color: #000; }

        .grid-container {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(320px, 1fr));
            gap: 30px; width: 100%; max-width: 1400px;
        }

        .card {
            background: var(--card-bg);
            border: none;
            border-radius: 12px; position: relative;
            transform: translateZ(0);
            backface-visibility: hidden;
            transition: transform 0.3s ease, box-shadow 0.3s ease;
            overflow: hidden;
        }

        /* 只有當不是禁用狀態且 hover 時才有效果 */
        .card:not(.disabled):hover { 
            box-shadow: var(--glow); 
            transform: translateY(-8px) translateZ(0); 
        }

        .card img { 
            width: 100%; 
            height: 240px; 
            object-fit: cover; 
            display: block; 
            background: #1a1a1a;
            transition: filter 0.3s ease, opacity 0.3s ease;
        }

        .card-info { 
            padding: 20px; text-align: center;
        }

        .card-title { margin: 0; font-size: 1.1rem; font-weight: 500; color: #ffffff; transition: color 0.3s; }

        /* --- 新增：反灰與禁用樣式 --- */
        .card.disabled img {
            filter: grayscale(100%); /* 圖片反灰 */
            opacity: 0.4; /* 增加透明度 */
        }

        .card.disabled .card-title {
            color: #666; /* 標題文字變暗 */
        }

        .card.disabled a {
            pointer-events: none; /* 禁用點擊連結功能 */
            cursor: default;
        }
        /* ----------------------- */

        .card-tools {
            position: absolute; top: 10px; right: 10px;
            display: none; gap: 6px; z-index: 10;
        }

        .tool-btn { 
            width: 35px; height: 35px; border: none; border-radius: 6px; 
            cursor: pointer; font-size: 16px; display: flex; align-items: center; justify-content: center;
            pointer-events: auto !important; /* 確保編輯按鈕在禁用狀態下仍可點擊 */
        }
        .edit-tool { background: var(--edit); color: #000; }
        .del-tool { background: var(--danger); color: #fff; }

        .modal {
            display: none; position: fixed; top: 0; left: 0;
            width: 100%; height: 100%; background: rgba(0,0,0,0.9);
            justify-content: center; align-items: center; z-index: 2000;
        }

        .modal-content {
            background: #1a1f26; padding: 30px; border: 1px solid var(--primary);
            width: 90%; max-width: 400px; border-radius: 8px;
        }

        input { 
            width: 100%; padding: 12px; margin: 10px 0; background: #000; 
            border: 1px solid #333; color: var(--primary); box-sizing: border-box; border-radius: 4px; 
        }
        .save-btn { 
            width: 100%; padding: 12px; background: var(--primary); color: #000; 
            border: none; font-weight: bold; cursor: pointer; margin-top: 10px; border-radius: 4px; 
        }
    </style>
</head>
<body>

    <h1 style="letter-spacing: 5px; margin-bottom: 60px; font-weight: 300; text-shadow: 0 0 20px rgba(255,255,255,0.1);">J君優化專案首頁</h1>

    <div class="admin-controls">
        <button class="btn" id="editModeBtn" onclick="toggleEditMode()">編輯模式</button>
        <button class="btn" onclick="openModal()">+ 新增項目</button>
    </div>

    <div class="grid-container" id="grid"></div>

    <div class="modal" id="modal">
        <div class="modal-content">
            <h2 id="modalTitle" style="color:var(--primary); margin-top:0;">編輯項目</h2>
            <input type="text" id="imgInput" placeholder="圖片路徑 (例: image.jpg)">
            <input type="text" id="titleInput" placeholder="標題">
            <input type="text" id="urlInput" placeholder="網址 (若無請輸入 #)">
            <button class="save-btn" onclick="handleSave()">確認儲存</button>
            <button class="save-btn" style="background:#444; color:#fff; margin-top:8px;" onclick="closeModal()">取消</button>
        </div>
    </div>

    <script>
        const defaultItems = [
            { img: "分潤計畫 EDM-更多精選商品.jpg", title: "分潤計畫 EDM-更多精選商品", url: "#" },
            { img: "信用卡回饋方案.jpg", title: "信用卡回饋方案", url: "#" },
            { img: "export.jpg", title: "大獎機台展示", url: "#" },
            { img: "SBA編輯器.png", title: "SBA編輯器系統", url: "#" },
            { img: "edm_734px_2026-01-20.jpg", title: "創意文案高轉化課程", url: "#" },
            { img: "國泰世華銀行_Banner (2).jpg", title: "國泰世華銀行 Banner", url: "#" },
            { img: "8月商城活動日曆（1200x1863｜第一列95折三條｜字體指定版） (1).jpg", title: "1月商城活動日曆", url: "#" },
            { img: "國泰蝦皮聯名卡MSBN.jpg", title: "國泰蝦皮聯名卡回饋", url: "#" }
        ];

        let items = JSON.parse(localStorage.getItem('portal_clean_v4')) || defaultItems;
        let isEditMode = false;
        let currentEditIndex = null;

        function render() {
            const grid = document.getElementById('grid');
            grid.innerHTML = items.map((item, index) => {
                const isDisabled = item.url === "#";
                return `
                <div class="card ${isDisabled ? 'disabled' : ''}">
                    <div class="card-tools" style="display: ${isEditMode ? 'flex' : 'none'}">
                        <button class="tool-btn edit-tool" onclick="openModal(${index})">✎</button>
                        <button class="tool-btn del-tool" onclick="deleteItem(${index})">✕</button>
                    </div>
                    <a href="${item.url}" ${isDisabled ? '' : 'target="_blank"'} onclick="${isEditMode ? 'return false;' : ''}">
                        <img src="${item.img}" loading="lazy">
                        <div class="card-info"><p class="card-title">${item.title}</p></div>
                    </a>
                </div>
                `;
            }).join('');
        }

        function toggleEditMode() {
            isEditMode = !isEditMode;
            document.getElementById('editModeBtn').innerText = isEditMode ? "結束編輯" : "編輯模式";
            render();
        }

        function openModal(index = null) {
            currentEditIndex = index;
            document.getElementById('modalTitle').innerText = index !== null ? "修改項目" : "新增項目";
            document.getElementById('imgInput').value = index !== null ? items[index].img : "";
            document.getElementById('titleInput').value = index !== null ? items[index].title : "";
            document.getElementById('urlInput').value = index !== null ? items[index].url : "#";
            document.getElementById('modal').style.display = 'flex';
        }

        function closeModal() { document.getElementById('modal').style.display = 'none'; }

        function handleSave() {
            const img = document.getElementById('imgInput').value;
            const title = document.getElementById('titleInput').value;
            let url = document.getElementById('urlInput').value.trim();
            
            if (!url) url = "#";
            if (!img || !title) return alert("請填寫完整內容");

            if (currentEditIndex !== null) items[currentEditIndex] = { img, title, url };
            else items.push({ img, title, url });

            localStorage.setItem('portal_clean_v4', JSON.stringify(items));
            render();
            closeModal();
        }

        function deleteItem(index) {
            if(confirm('確定刪除此項？')) {
                items.splice(index, 1);
                localStorage.setItem('portal_clean_v4', JSON.stringify(items));
                render();
            }
        }

        render();
    </script>
</body>
</html>
